<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
<title>Import from CSV</title>

<style type="text/css">
/*margin and padding on body element
  can introduce errors in determining
  element position and are not recommended;
  we turn them off as a foundation for YUI
  CSS treatments. */
body {
	margin:0;
	padding:0;
}
</style>

<link rel="stylesheet" type="text/css" href="<%=nearestPath%>web/yui/build/fonts/fonts-min.css" />
<!-- Individual YUI CSS files --> 
<link rel="stylesheet" type="text/css" href="<%=nearestPath%>web/yui/build/tabview/assets/skins/sam/tabview.css"> 
<!-- Individual YUI JS files --> 
<script type="text/javascript" src="<%=nearestPath%>web/yui/build/yahoo-dom-event/yahoo-dom-event.js"></script> 
<script type="text/javascript" src="<%=nearestPath%>web/yui/build/element/element-min.js"></script> 
<script type="text/javascript" src="<%=nearestPath%>web/yui/build/tabview/tabview-min.js"></script> 

<!--there is no custom header content for this example-->
<script type="text/javascript">
YAHOO.util.Event.onDOMReady(
	function(){ 
		var tabView = new YAHOO.widget.TabView('demo');
		YAHOO.util.Event.on('nextButton','click', 
			function(){
				var nextIndex = tabView.get('activeIndex') + 1;
				var nextTab = tabView.getTab(nextIndex);
				if(nextTab)
					tabView.set('activeIndex', nextIndex);
				var nextNextTab = tabView.getTab(nextIndex + 1);
				var nextButton = document.getElementById('nextButton');
				YAHOO.util.Dom.setStyle(nextButton, 'disabled', (nextNextTab == null) ? 'true' : 'false');
			}
		);
		
	}
);
</script>

</head>

<body class=" yui-skin-sam">

<div class="exampleIntro">
	<p>This wizard helps import bulk data (in CSV) to create or update requests</p>
</div>

<!--BEGIN SOURCE CODE FOR EXAMPLE =============================== -->

<div id="demo" class="yui-navset">
    <ul class="yui-nav">
        <li class="selected"><a href="#tab1"><em>Download Template</em></a></li>
        <li><a href="#tab2"><em>Import Data</em></a></li>

    </ul>            
    <div class="yui-content">
        <div style="height:15em">
        	
        
		<p>Click &#39;<a href="<%=nearestPath%>importdata?ba=<%=sysPrefix%>">template.csv</a>&#39; on this tab<br>
		Click &#39;Save to Disk&#39; on the window prompt and click &#39;OK&#39; Open the template<br>
		The first two rows on the template contain field names and field display 
		names respectively.<br>
		Fill in data from the third row. You can use Microsoft 
		Excel or any text editor to edit this file<br>
		To update a request instead of creating a new one, mention the request 
		id in the &#39;request_id&#39; column<br>
		Click &#39;Next.&#39; This will take you to the &#39;Import Data&#39; tab.</p>
        <span><a href="<%=nearestPath%>importdata?ba=<%=sysPrefix%>"><strong>template.csv</strong></a></span>	
        <span style="float:right"><button id="nextButton">Next&gt;&gt;</button></span>
        </div>
        <div style="height:15em">
        <form method="post" action="<%=nearestPath%>importdata" enctype="multipart/form-data">
        	<input type="hidden" name="ba" value="<%=sysPrefix%>">
        	<p>Upload the CSV File <input name="File1" type="file">&nbsp;<input type="submit" name="Submit" value="Submit" id="submitcsvbutton"/></p>
			<p>Click &#39;Browse.&#39; Select the file containing data in the template 
			format. <br>
			Click &#39;Submit.&#39; This will upload the data and create or update 
			requests. This may take some time.<br>
			Click &#39;Save As&#39; on the window prompt to save the uploaded results.<br>
			NB: Uploading the data may take some time. You can open tbits in a 
			new browser window to check its progress</p>
        </form>
        	<div id="import-results" style="visibility:hidden">
        	<p>Results:</p>
        	<p>The following records were not added. <a href="x">failed_Requests.csv</a></p>
        	<p>The following records were successfully added. <a href="x">Added_Requests.csv</a></p>
        	</div>
        </div>
    </div>
    
</div>
</body>
</html>
