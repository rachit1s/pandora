<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
 "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>  
<meta content="text/html; charset=utf-8" http-equiv="content-type">
<title>Add transmittal template</title>

<style type="text/css">
	/*margin and padding on body element
	  can introduce errors in determining
	  element position and are not recommended;
	  we turn them off as a foundation for YUI
	  CSS treatments. */
	body {
		margin:0;
		padding:0;
	}
</style>
<link rel="stylesheet" type="text/css" href="<%=nearestPath%>web/yui/build/fonts/fonts-min.css">
<link rel="stylesheet" type="text/css" href="<%=nearestPath%>web/yui/build/logger/assets/skins/sam/logger.css">
<link rel="stylesheet" type="text/css" href="<%=nearestPath%>web/yui/build/treeview/assets/skins/sam/treeview.css">
<link rel="stylesheet" type="text/css" href="<%=nearestPath%>web/yui/build/button/assets/skins/sam/button.css">
<link rel="stylesheet" type="text/css" href="<%=nearestPath%>web/yui/build/autocomplete/assets/skins/sam/autocomplete.css">

<script type="text/javascript" src="<%=nearestPath%>web/yui/build/yahoo/yahoo.js"></script>
<script type="text/javascript" src="<%=nearestPath%>web/yui/build/yuiloader/yuiloader-beta-min.js"></script>
<script type="text/javascript" src="<%=nearestPath%>web/yui/build/yahoo/event.js"></script>
<script type="text/javascript" src="<%=nearestPath%>web/yui/build/event/event-min.js"></script>
<script type="text/javascript" src="<%=nearestPath%>web/yui/build/dom/dom-min.js"></script>
<script type="text/javascript" src="<%=nearestPath%>web/yui/build/yahoo-dom-event/yahoo-dom-event.js"></script>
<script type="text/javascript" src="<%=nearestPath%>web/yui/build/animation/animation-min.js"></script>
<script type="text/javascript" src="<%=nearestPath%>web/yui/build/autocomplete/autocomplete-min.js"></script>
<script type="text/javascript" src="<%=nearestPath%>web/yui/build/yahoo/connection.js"></script>
<script type="text/javascript" src="<%=nearestPath%>web/yui/build/utilities/utilities.js"></script>
<script type="text/javascript" src="<%=nearestPath%>web/scripts/json2.js"></script>
<script type="text/javascript" src="<%=nearestPath%>web/scripts/admin-utils.js"></script>

<style type="text/css">
	.ygtvcheck0 { background: url(<%=nearestPath%>web/yui/assets/img/check/check0.gif) 0 0 no-repeat; width:16px; cursor:pointer }
	.ygtvcheck1 { background: url(<%=nearestPath%>web/yui/assets/img/check/check1.gif) 0 0 no-repeat; width:16px; cursor:pointer }
	.ygtvcheck2 { background: url(<%=nearestPath%>web/yui/assets/img/check/check2.gif) 0 0 no-repeat; width:16px; cursor:pointer }
</style>

<style type="text/css">
	#expandcontractdiv {border:1px solid #336600; background-color:#FFFFCC; margin:0 0 .5em 0; padding:0.2em;}
	#treeDiv1 { background: #fff }
</style>

<style type="text/css">
	/* custom styles for multiple stacked instances */
	#userautocomplete1, #userautocomplete2 {
		width:200px;  /*set width here */
		padding-bottom:2em;
	}
	#userautocomplete1, #userautocomplete2 {
		/*z-index:9000;  z-index needed on top instance for ie & sf absolute inside relative issue */
	}
	/*
	#userinput1, #userinput2 {
		_position:absolute; /* abs pos needed for ie quirks
	} */
</style>

<script type="text/javascript">
	function setAction(){		
		document.addTransmittalTemplateForm.action = "<%=nearestPath%>admin-transmittals/<%=sysPrefix%>";
		document.addTransmittalTemplateForm.submit();
	}	
</script>
</head>

<body style="background-color:#FFFFFF; width:100%">	
	<DIV  class ="bbn"  style="width:100%">
    	<TABLE id="Table1" cellSpacing="0" cellPadding="0"style="width:100%; background-image:url(<%=nearestPath%>web/images/header-sec.gif); background-repeat:repeat-x;">
        	<TR class="sxs"><td align="top"><img src="<%=nearestPath%>web/images/header-first.gif" /></td>
            	<td align="left">
                	<DIV class="m">
                    	<div>Administration - Add Transmittal Template
                        	<!--SELECT id="sys_ids" size="1" name="Select1" onChange="javascript:onPropertyChangeSysIdProperties()">
                            	<%=sys_ids%>
                            </SELECT-->
                        </div>
                    </DIV>
                </TD>
                <td><div align="right">
					<span class="lc sx b cw"><%=userLogin%></span><span class="l sx b cw" style="display:<%=display_logout%>">|<a href="<%=nearestPath%>logout"/>Logout</a></span><br>
					<SPAN class="l cw" id="" onClick="window.open('<%=nearestPath%>web/tbits-help.htm#WhatIsConfigurable');"><img src="<%=nearestPath%>web/images/help.gif">&nbsp;Help</SPAN> </div></TD>
             </TR>
    	</TABLE>
	</DIV> <!-- panel header -->
			
	<div style="background-color:#E6F4FD; margin: 0ex 1ex 0.5ex;border:0.2ex solid #CBCBCB;">
		<p class="style2" style="font-weight:bold">Add a transmittal template</p>		
		<form id="addTemplateId"  name="addTransmittalTemplateForm" action='<%=nearestPath%>add-transmittal-template/<%=sysPrefix%>'>
			<input type="hidden" id="actionTypeId" name="actionType" value="<%=saveType%>" />
			<td><input  type="hidden"id="template_id" type="text" name="templateId" value="<%=templateId%>"/></td>
			<table>				
				<tr>
			  		<td>Template Name:</td>
					<td><input type="text" name="templateName" value="<%=templateName%>" size="40" /></td>
				</tr>
				<tr>
			  		<td>File Name:</td>
					<td><input name="fileName" size="40" value="<%=fileName%>"></input></td>
				</tr>
				<tr><td></td><td></td></tr>
			    <tr>
			  		<td>Assignees: </td>
					<td style="vertical-align:top">
						<div class=" yui-skin-sam">
							<div id="tolistautocomplete">
								<input id="tolistinput" name="toList" type="text" style="width:825px" value="<%=toList%>">
								<div id="tolistcontainer"></div>
							</div>
		            	</div>
					</td>
				</tr>
				<tr><td></td><td></td></tr>
			  	<tr>
			  		<td>Subscribers: </td>
					<td style="vertical-align:top">
						<div class=" yui-skin-sam">
							<div id="cclistautocomplete">
								<input id="cclistinput" name="ccList" type="text" style="width:825px" value="<%=ccList%>">
							<div id="cclistcontainer"></div>
							</div>
		            	</div>
					</td>
				</tr>
			  </table>
			  <div>
				<input id="saveEscCondition" name="Save" type="submit" value="Save"/>
			  </div>	
		</form>
		<script type="text/javascript">
			YAHOO.namespace("transbit.templates");
			var usersList = <%=usersList%>;		
			YAHOO.transbit.templates.ACJSArray1=autoCompleteFunction ('tolistinput', 'tolistcontainer', usersList);
			YAHOO.transbit.templates.ACJSArray2=autoCompleteFunction ('cclistinput', 'cclistcontainer', usersList);	
			function autoCompleteFunction (userinput, usercontainer, itemsList){
				// Instantiate second JS Array DataSource
				this.oACDS = new YAHOO.widget.DS_JSArray(itemsList);
											
				// Instantiate first AutoComplete
				this.oAutoComp = new YAHOO.widget.AutoComplete(userinput,usercontainer,this.oACDS);
				this.oAutoComp.prehighlightClassName = "yui-ac-prehighlight";
				this.oAutoComp.typeAhead = true;
				this.oAutoComp.useShadow = true;
				this.oAutoComp.minQueryLength = 0;
				this.oAutoComp.delimChar = [",",";"];
				this.oAutoComp.textboxFocusEvent.subscribe(function(){
					var sInputValue = YAHOO.util.Dom.get(userinput).value;
					if(sInputValue.length === 0) {
						var oSelf = this;
						setTimeout(function(){oSelf.sendQuery(sInputValue);},0);
					}
				});								
			}
		</script>
		<script type="text/javascript">
		function saveTrTemplate(){
		//"<%=nearestPath%>add-transmittal-template/<%=sysPrefix%>";
		}
		</script>
	</div>	
</body>
</html>

