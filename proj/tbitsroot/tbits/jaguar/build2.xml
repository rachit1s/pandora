<?xml version="1.0" encoding="UTF-8"?>
<!-- ====================================================================== 
     Sep 29, 2009 3:49:51 PM                                                        

     project    
     Copies the _war into destination
                   
     sandeepgiri                                                                
     ====================================================================== -->
<project name="project" default="default">
    <description>
            Copies the _war into destination
    </description>

    <!-- ================================= 
          target: default              
         ================================= -->
    <target name="default" depends="prepare,calculate-plugins" description="Copies the _war into destination">
        
    </target>

	<target name="define">
		<property file="build.properties" />
	</target>

	<target name="copy-modules" depends="define">
		<copy todir="war/WEB-INF/classes">
			<fileset dir="src/java" />
			<fileset dir="${gwtplugins.dir}/${customer}" />
		</copy>
	</target>

    	<target name="calculate-plugins" depends="define">
		<java failonerror="true" fork="true" classname="compiler.Compiler">
		      <classpath>
			<pathelement location="war/WEB-INF/classes"/>
		      </classpath>
		      <jvmarg value="-Xmx512M"/>
			<arg value="war/WEB-INF/classes"/>
			<arg value="tbits"/>
			<arg value="./src/java/com/tbitsGlobal/jaguar"/>
	    	</java>

		<java failonerror="true" fork="true" classname="compiler.Compiler">
		      <classpath>
			<pathelement location="war/WEB-INF/classes"/>
		      </classpath>
		      <jvmarg value="-Xmx512M"/>
			<arg value="war/WEB-INF/classes"/>
			<arg value="admin"/>
			<arg value="./src/java/com/tbitsGlobal/admin"/>
	    	</java>
	</target>

    <!-- - - - - - - - - - - - - - - - - - 
          target: prepare                      
         - - - - - - - - - - - - - - - - - -->
    <target name="prepare" depends="preparejetty">
	<mkdir dir="war/jaguar"/>
	<copy file="src/lib/web.xml" tofile="war/WEB-INF/web.xml" />
    </target>
	
	<!-- - - - - - - - - - - - - - - - - - 
		          target: preparejetty 
		          
		         - - - - - - - - - - - - - - - - - -->
	
	<target name="preparejetty" >
		<description>
			Copies jetty-web.xml in war/WB_INF/jetty-web.xml. 
			After including the ehcache, certain classes need to be invisible to gwt.	
		</description>
			<copy file="jetty-web.xml" tofile="war/WEB-INF/jetty-web.xml"></copy>
		</target>
</project>
