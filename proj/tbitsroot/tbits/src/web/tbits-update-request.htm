<script>
	var uploaders = {};
	var Event = YAHOO.util.Event;
	var Dom = YAHOO.util.Dom;
	 function init(){
		 displayAttEditorInTable();
	 }
	 YAHOO.util.Event.onDOMReady(init);
        /*
         * Please do not move this function from here. 
         * If you still want to move this, then please see to it that 
         * this gets loaded before the body of the document, 
         * i.e. place the corresponding script tag before <BODY> tag.
         * 
         * thanks!!
         */        
        function changeSecList(primFieldMap, primFieldName, secFieldName)
        {
            var primTypeName = document.getElementById(primFieldName).value;
            var map = primFieldMap[primTypeName];
            var str = new Array();
            if (!map)
            {
                map = primFieldMap["__complete_list__"];
            }
            var ctrl = document.getElementById(secFieldName);
            if (ctrl != null)
            {
                if (ctrl.disabled == true) return;
                ctrl.options.length = 0;
                var length = map.length;
                for (var i=0 ; i< length; i++)
                {
                    var obj = map[i];
                    ctrl.options.length = i+1;
                    ctrl.options[i].value = obj["name"];
                    ctrl.options[i].text  = obj["display_name"];
                }
            }
            else
            {
                alert("Invalid control: " + secFieldName);
            }
        }
</script>
         <script language="javascript" src="<%=nearestPath%>web/jspspellcheck/spellcheck-caller.js"></script>
		<script language="JavaScript">
		    function spellCheck( textareaId)
    {
        // Build an array of form elements (not there values)
        var elements = new Array(0);

        // Your form elements that you want to have spell checked
      
        elements[elements.length] = document.getElementById(textareaId);

        // Start the spell checker
        startSpellCheck( "<%=nearestPath%>web/jspspellcheck/", elements );
    }
		</script>
<div style="height: 0px;display:none">
    <iframe id='hiddenIFrame' name='hiddenIFrame' style="display:none" onload="onIframeBodyLoad()"></iframe>
</div>
<div><iframe scrolling="no" frameborder="0" style="position: ABSOLUTE; filter: alpha{opacity=0};display: none; visibility: hidden;"
            src="about:blank" name="draftsIFrame" id="draftsIFrame"></iframe></div>
<FORM name="addRequestForm" id="addRequestForm" method="post" onkeydown="onKeyPressForm(event)" onSubmit='javascript:{return onFormSubmit();}'>
    <INPUT type="hidden" name="systemId" id="systemId" value="<%=systemId%>" /> <INPUT type="hidden" name="sysPrefix" id="sysPrefix" value="<%=sysPrefix%>" />
    <input type="hidden" name="clientOffset" id="clientOffset" value="" /> <INPUT type="hidden" name="loggedDate" id="loggedDate" value="<%=loggedDate%>" />
    <INPUT type="hidden" name="sendMail" id="sendMail" value="<%=sendMail%>" /> <INPUT type="hidden" name="mailLoggers" id="mailLoggers" value="<%=mailLoggers%>" />
    <INPUT type="hidden" name="loggerStatus" id="loggerStatus" value="" /> <INPUT type="hidden" name="caller" id="caller" value="2" />
    <INPUT type="hidden" name="requestId" id="requestId" value="<%=requestId%>" /> <INPUT type="hidden" name="show_exception_block" id="show_exception_block" value="<%=show_exception_block%>" />
    <INPUT type="hidden" name="action_diff_exception" id="action_diff_exception" value="<%=action_diff_exception%>" />
    <INPUT type="hidden" name="openSummary" id="openSummary" value="<%=openSummary%>" />
    <INPUT type="hidden" name="openExtended" id="openExtended" value="<%=openExtended%>" />
    <INPUT type="hidden" name="openAssociate" id="openAssociate" value="<%=openAssociate%>" />
    <INPUT type="hidden" name="openRelated" id="openRelated" value="<%=openRelated%>" />
    <INPUT type="hidden" name="csList" id="csList" value="<%=csList%>" /> <INPUT type="hidden" id="execFunctions" name="execFunctions" value="<%=execFunctions%>" />
    <input type="hidden" id="maxActionId" name="maxActionId" value="<%=maxActionId%>" />
    <input type="hidden" id="diffList" name="diffList" value="<%=diffList%>" /> <input type="hidden" id="repliedToAction" name="repliedToAction" value="<%=repliedToAction%>" />
    <input type="hidden" id="diffFieldList" name="diffFieldList" value="<%=diffFieldList%>" />
    <input type="hidden" name="strDueDate" value="<%=due_datetime%>" ID="Hidden2"/> <input type="hidden" name="due_date_option" value="<%=due_date_option%>" ID="due_date_option"/>
    <input type="hidden" name="due_time_disabled" value="<%=due_time_disabled%>" ID="due_time_disabled"/>
    <input type="hidden" name="redirection" value="" ID="redirection" /> <input type="hidden" name="DTimestamp" value="<%=DTimestamp%>" ID="DTimestamp" />
    <input type="hidden" name="autoSaveRate" value="<%=autoSaveRate%>" ID="autoSaveRate" />
    <input type="hidden" name="nearestPath" id="nearestPath" value="<%=nearestPath%>" />
    <input type="hidden" name="is_draft" value="<%=is_draft%>" id="is_draft" /> <input type="hidden" name="parentWindow" id="parentWindow" value="view-request" />
	<input type="hidden" name="webDateFormat" value="<%=calendar_date_format%>" ID="webDateFormat" />
    <table cellpadding="0" cellspacing="2" width="100%" ID="Table4" style="margin-left: 0ex; margin-right: -0.3ex">
    <input type="hidden" name="draftId" value="<%=draftId%>" ID="draftId" />
        <colgroup>
            <col width="10%" />
            <col />
            <col width="20%" />
            <col width="10%" />
            <col />
            <col width="20%" />
            <col width="40%" />
        </colgroup>
        <tbody>
            <tr>
                <td height="5" style="border: 1px solid red"></td>
            </tr>
            <tr>
                <td align="right">
                    <span class="sx <%=privateClassName%>" nowrap id="confidential" style="margin-left: -5px">&nbsp;<%=is_private_label%>&nbsp;</span>
                </td>
                <td>&nbsp;</td>
                <td>
                    <input onchange="javascript:frmChanged()" onkeydown="onKeyDownField(event);" onclick="javascript:onChangeConfidential()" name="is_private" 
                    <%=is_private%> <%=is_private_disabled%> id="is_private" type="checkbox">
                </td>
                <!-- <td>&nbsp;</td>
                <td>&nbsp;</td>
                <td>&nbsp;</td>-->
                <td class="s b" align="right" nowrap="nowrap">
                <!--div style="display:<%=office_id_display%>" >
                    <%=office_id_label%>
                </div-->
                </td>
                <td>&nbsp;
                    
                </td>
                <td align="left">
                <div style="display:<%=office_id_display%>" >
                    <select <%=office_id_disabled%> class="sx" tabindex="8" size="1" name="office_id" onkeydown="onKeyDownField(event);" id="Select1" onchange="javascript:frmChanged();">
                        <%=office_id_list%>
                    </select>
                </div>
                </td>
                <td rowspan="5" valign="top">
                    <!--<div class="m dnb">-->
                    <div class="dm exb" id="exceptionBlock" style="display: none;" >
                        <div class="bex dp">
                            <table id="Table5" cellpadding="0" cellspacing="0" width="100%">
                                <tbody>
                                    <tr>
                                        <td class="s b cw" align="left">Errors:</td>
                                        <td class="s" align="right" style="display: none;">(click on the link to update)</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <div class="bw dp" id="exceptions"><%=exception_list%></div>
                    </div>
                </td>
            </tr>
            <tr>
                <td class="s b" align="right" nowrap="nowrap"><%=category_id_label%></td>
                <td>&nbsp;</td>
                <td align="left">
                    <select <%=category_id_disabled%> class="sx" tabindex="3" size="1" name="category_id" id="category_id"  
                        onchange="javascript:onChangeCategory();" 
                        onfocus = "javascript:onChangeCategory()" 
                        onkeydown="onKeyDownField(event);">
                        <%=category_id_list%>
                    </select>
                </td>
                <td class="s b" align="right" nowrap="nowrap"><%=severity_id_label%></td>
                <td>&nbsp;</td>
                <td align="left">
                    <select class="sx" <%=severity_id_disabled%> onkeydown="onKeyDownField(event);" tabindex="4" size="1" name="severity_id" 
                        id="severity_id" onchange="javascript:frmChanged();">
                        <%=severity_id_list%>
                    </select>
                </td>
            </tr>
            <tr>
                <td align="right" nowrap="nowrap">
                    <span class="s b cb l" onclick="javascript:openAssigneePicker()">
                        <%=assignee_ids_label%>
                    </span>
                </td>
                <td>&nbsp;</td>
                <td align="left">
                    <input class="sx wickEnabled" style="width: 99%;" tabindex="5" id="assignee_ids" onchange="onTypeAssigneeIds();frmChanged()" 
                       onfocusout="javascript:onTypeAssigneeIds();" name="assignee_ids" 
                       value="<%=assignee_ids%>" <%=assignee_ids_disabled%> type="text">
                </td>
                <td align="right" nowrap="nowrap">
                    <span class="s b cb l" onclick="javascript:openUserPicker(document.all.logger_ids)">
                        <%=logger_ids_label%>
                    </span>
                </td>
                <td>&nbsp;</td>
                <td align="left">
                    <input class="sx wickEnabled" style="width: 99%;" tabindex="6" id="logger_ids" onchange="javascript:frmChanged()" 
                       name="logger_ids" value="<%=logger_ids%>" <%=logger_ids_disabled%> type="text">
                </td>
            </tr>
            <tr>
                <td class="s b" align="right" nowrap="nowrap"><%=status_id_label%></td>
                <td>&nbsp;</td>
                <td align="left">
                    <select <%=status_id_disabled%> class="sx" tabindex="7" size="1" name="status_id" 
                        onkeydown="onKeyDownField(event);" id="status_id" onchange="javascript:frmChanged()">
                        <%=status_id_list%>
                    </select>
                </td>
                <td class="s b" align="right" nowrap="nowrap"><%=request_type_id_label%></td>
                <td>&nbsp;</td>
                <td align="left">
                    <select <%=request_type_id_disabled%> class="sx" tabindex="8" size="1" name="request_type_id" 
                        onkeydown="onKeyDownField(event);" id="request_type_id" onchange="javascript:frmChanged();">
                        <%=request_type_id_list%>
                    </select>
                </td>
            </tr>
            <tr>
                <td class="s b" align="right" nowrap="nowrap"><%=notify_label%></td>
                <td>&nbsp;</td>
                <td align="left">
                    <table cellpadding="0" cellspacing="0" width="100%" ID="Table7">
                        <tbody>
                            <tr>
                                <td>
                                    <input tabindex="9" <%=notify%> <%=notify_disabled%> 
                                       onkeydown="onKeyDownField(event);" 
                                       onchange="javascript:frmChanged()" name="mailSend"
                                       id="mailSend" onclick="javascript:onChangeMailSend()" type="checkbox">
                                </td>
                                <td class="s" nowrap>&nbsp;By Email&nbsp;|&nbsp;</td>
                                <td>
                                    <input tabindex="10" <%=notify_loggers%> <%=notify_loggers_disabled%> 
                                       onkeydown="onKeyDownField(event);" 
                                       onchange="javascript:frmChanged()" name="chkLoggers"
                                       id="chkLoggers" onclick="javascript:onChangeLoggers()" type="checkbox">
                                </td>
                                <td class="s" nowrap>&nbsp;Logger(s)</td>
                                <td width="100%"></td>
                            </tr>
                        </tbody>
                    </table>
                </td>
                <td class="s b" align="right" nowrap="nowrap" style="display: <%=datetime_display%> ">
                    <%=due_datetime_label%>
                </td>
                <td>&nbsp;</td>
                <td align="left" style="display: <%=datetime_display%> ">
                    <table cellpadding="0" cellspacing="0" width="100%" ID="Table9">
                        <tbody>
                            <tr>
                                <td>
                                    <input class="sx" style="width: 110px" value="<%=due_datetime%>" 
                                       onkeydown="onKeyDownField(event);" <%=due_datetime_disabled%> 
                                       onchange="javascript:frmChanged()" tabindex="11" name="due_datetime" 
                                       id="due_datetime" type="text">
                                </td>
                                <td>
                                    <img id="_due_date_img_cal" style="display: <%=due_datetime_img_display%>" 
                                     src="<%=nearestPath%>web/images/cal.gif" 
                                     onmouseover="calendarSetup('<%=calendar_date_format%>');" onfocus="calendarSetup('<%=calendar_date_format%>');" height="22" style="am">
                                </td>
                                <td width=100% nowrap align="right">
                                    <table cellpadding="0" cellspacing="0" width="100%" ID="Table11" style="display:<%=time_option_disabled%>">
                                        <tbody>
                                            <tr>
                                                <td>
                                                    <input tabindex="12" onkeydown="onKeyDownField(event);" 
                                                       onchange="javascript:frmChanged()" <%=due_datetime_disabled%> name="timeOption" 
                                                       id="timeOption" type="checkbox" onclick="javascript:onClickDisableTime()">
                                                </td>
                                                <td noWrap align="left">
                                                    <span class="s" id="disableTime" noWrap>
                                                        <%=disableTime%>
                                                    </span>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </td>
            </tr>
            <tr>
                <td align="right" nowrap="nowrap">
                    <span class="s b cb l" onclick="javascript:openUserPicker(document.all.cc_ids)">
                        <%=cc_ids_label%>
                    </span>
                </td>
                <td>&nbsp;</td>
                <td colspan="5" align="left">
                    <input class="sx wickEnabled" style="width: 99%;" tabindex="12" id="cc_ids" 
                       onchange="javascript:frmChanged()" name="cc_ids" value="<%=cc_ids%>" <%=cc_ids_disabled%> type="text">
                </td>
            </tr>
            <tr>
                <td align="right" nowrap="nowrap">
                    <span class="s b cb l" onclick="javascript:openUserPicker(document.all.subscriber_ids)">
                        <%=subscriber_ids_label%>
                    </span>
                </td>
                <td>&nbsp;</td>
                <td colspan="5" align="left">
                    <input class="sx wickEnabled" style="width: 99%;" tabindex="13" id="subscriber_ids" 
                       onkeydown="onKeyDownField(event);"  onchange="javascript:frmChanged()" name="subscriber_ids" 
                       value="<%=subscriber_ids%>" <%=subscriber_ids_disabled%> type="text">
                </td>
            </tr>
            <tr>
                <td class="s b" align="right" nowrap="nowrap"><%=subject_label%></td>
                <td>&nbsp;</td>
                <td colspan="5" align="left">
                    <input class="sx" style="width: 99%;" tabindex="14" onchange="javascript:frmChanged();" 
                       onkeydown="onKeyDownField(event)" name="subject" id="subject"  
                       value="<%=subject%>" <%=subject_disabled%> type="text">
                </td>
            </tr>
            <tr class="s">
                <td align="right">&nbsp;</td>
                <td>&nbsp;</td>
                <td align="left" colspan="5">
                    <%=efLink%>
                    <%=attachLink%>
                    <%=associateLink%>
                    <%=relatedLink%>
                    <%=summaryLink%>
                </td>
            </tr>
            <!--Extended Fields-->
            <%=extended_fields%>
            <!-- Attachments -->
            <%=attachCtrl%>
            <!-- Associate Request-->
            <%=associateCtrl%>
            <!--Related Request-->
            <%=relatedCtrl%>
            <!--Summary Field-->
            <%=summaryCtrl%>
            <!--Description field-->
            <tr>
                <td class="s b" align="right" nowrap="nowrap">
                    <%=description_label%>
                </td>
                <td align="right" nowrap colspan="6">
                    <button type="button" class="sx" id="description_tglBtn">Toggle <%=description_label%></button>                  
                </td>
            </tr>
	<tr class="yui-skin-sam">
		<td colspan="7" align="left" valign="top">
			<input type="hidden" id="description_content_type" name="description_content_type" value="html" />
			<textarea tabIndex="78" class="sx ff" style="width:99%; height: 100%;" 
				wrap="soft" ID="description" onkeydown="onKeyDownField(event);" 
                          	name="description" rows="9" <%=description_disabled%> ><%=description%>
			</textarea>
			<script language='javascript'>
				toggleControl('description', 'description_tglBtn');
				createRichTextEditorsInRequestPage();
			</script> 			
		</td>
	</tr>
            
            <tr>
			<td colspan="7">
				<table>
				<tbody>
				<tr>
                <td width="5%">
                    <input class="cw b bn sxs lsb" value="Submit" id="btnSubmit2" onclick="javascript:onSubmit()"
                        height="25" type="button" width="100" NAME="btnSubmit2" tabIndex="80">                   
                </td>                               
                <td width="90%">
                	<table>
                	<tbody>
                	<tr>
                		<%=updateRequestFooterSlot%>
                	</tr>
                	</tbody>
                	</table>    
                </td>
                
				<td width="10%"> 
					<input class="cw b bn sxs lsb" value="Spell Check..." id="description_spellCheckButton" type="button" NAME="btnSpellCheck"
                      style='visibility:hidden' tabIndex="82" onclick="javascript:spellCheck('description');"></td>
				
				<td width="5%">
					<input class="cw b bn sxs lsb" value="Save Draft" id="btnSaveDraft" type="button" NAME="btnSaveDraft"
                        tabIndex="81" onclick="javascript:onClickSaveDraft()">
				</td>
				</tr>
				<tr>
				<td colspan='100' align='right'>
				<span class="sx" id="spnMessage" name="spnMessage"></span>
				</td>
				</tr>
				</tbody>
				</table>
				</td>
            </tr>
            <tr>
                <TD colSpan="7" height="10"></TD>
            </tr>
        </tbody>
    </table>
</FORM>

<script type='text/javascript'>
var requestFiles = <%=requestFiles%>;
</script>

<div style="display: none;" id="showDiff" name="showDiff" width="100%">
    <%=showDiff%>
</div>
