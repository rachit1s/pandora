<?xml version="1.0" ?>
<!-- 
The grammer is as follows:
The tag 'Rules' is a collection of 'Rule' tags. 
All of these rules are executed in mutually exclusive manner. 
A Rule is a collection of 'Condition' tags and Action tag.

	
-->

<Rules>
    <Rule>
        <Condition>
            <Check state="2" fieldName="category_id">
                <Old value="pending" operator="EQUALS" />
                <New value="*" operator="EQUALS" />
            </Check>
        </Condition>
        <Action>
            <Validate fieldName="assignee_ids" value="" operator="NE" />
        </Action>
        <Message value="Requests in pending category cannot be transferred without an assignee." />
    </Rule>
    <Rule>
        <Condition>
            <Check state="current" fieldName="category_id">
                <Current value="pending" operator="EQUALS" />
            </Check>
        </Condition>
        <Action>
            <Validate fieldName="status_id" value="closed" operator="NE" />
        </Action>
        <Message value="Requests in pending category cannot be closed." />
    </Rule>
    <Rule>
        <Condition>
            <Check state="current" fieldName="assignee_ids">
                <Current value="" operator="EQ" />
            </Check>
        </Condition>
        <Action>
            <Validate fieldName="status_id" value="closed" operator="NE" />
        </Action>
        <Message value="Unassigned Requests cannot be closed." />
    </Rule>
    <Rule>
        <Condition>
            <Check state="current" fieldName="assignee_ids">
                <Current value="" operator="EQ" />
            </Check>
        </Condition>
        <Action>
            <Validate fieldName="status_id" value="active" operator="NE" />
        </Action>
        <Message value="Unassigned Requests cannot be in active state." />
    </Rule>
    <Rule>
        <Condition>
            <Check state="current" fieldName="logger_ids">
                <Current value="giris,ritesh,lokesh" operator="IN" />
            </Check>
        </Condition>
        <Action>
            <Modify fieldName="subscriber_ids" value="manish" operator="APPEND" />
        </Action>
        <Message value="Always subscribe manish to requests logged by giris/ritesh/lokesh" />
    </Rule>
	<Rule>
		<Condition>
			<Check state="change" fieldName="status_id">
				<OLD operator="NE" value="closed"/>
				<NEW operator="EQ" value="closed"/>
			</Check>
		</Condition>
		<Action>          
			<Validate fieldName="logger_ids" operator="EQ" value="$user_id" />      
		</Action>      
		<Message value="Only the logger can close a request."/>
	</Rule>
</Rules>
<!-- 
List of operators:
    Check: EQ    NE    LT    LE    GT    GE    IN  
	Modify: APPEND    PREPEND    REPLACE    REMOVE   SET
-->
