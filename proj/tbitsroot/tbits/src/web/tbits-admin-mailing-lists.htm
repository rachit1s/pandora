<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
    <head>
        <title>
            <%=title%>
        </title>
        <meta name="vs_targetSchema" content="http://schemas.microsoft.com/intellisense/ie5">     
		
<style type="text/css">
/*margin and padding on body element
  can introduce errors in determining
  element position and are not recommended;
  we turn them off as a foundation for YUI
  CSS treatments. */
body {
	margin:0;
	padding:0;

}
.yui-skin-sam .yui-dt-liner { white-space:normal;	overflow: auto; word-break:break-all}
</style>
		<link rel="stylesheet" type="text/css" href="<%=nearestPath%>web/yui/build/fonts/fonts-min.css" />
		<link rel="stylesheet" type="text/css" href="<%=nearestPath%>web/yui/build/container/assets/skins/sam/container.css" />
		<link rel="stylesheet" type="text/css" href="<%=nearestPath%>web/yui/build/resize/assets/skins/sam/resize.css" />
		<link rel="stylesheet" type="text/css" href="<%=nearestPath%>web/yui/build/datatable/assets/skins/sam/datatable.css" />
		<link rel="stylesheet" type="text/css" href="<%=nearestPath%>web/css/dialogpanel.css" />
		<link rel="stylesheet" type="text/css" href="<%=nearestPath%>web/yui/build/paginator/assets/skins/sam/paginator.css" />
		
		<script type="text/javascript" src="<%=nearestPath%>web/yui/build/yahoo/yahoo-min.js"></script>
		<script type="text/javascript" src="<%=nearestPath%>web/yui/build/yuiloader/yuiloader-min.js"></script>	
		<script type="text/javascript" src="<%=nearestPath%>web/yui/build/yahoo-dom-event/yahoo-dom-event.js"></script>
		<script type="text/javascript" src="<%=nearestPath%>web/yui/build/dragdrop/dragdrop-min.js"></script>
		<script type="text/javascript" src="<%=nearestPath%>web/yui/build/utilities/utilities.js"></script>
		<script type="text/javascript" src="<%=nearestPath%>web/yui/build/container/container.js"></script>
		<script type="text/javascript" src="<%=nearestPath%>web/yui/build/resize/resize-min.js"></script>
		<script type="text/javascript" src="<%=nearestPath%>web/yui/build/element/element-min.js"></script>
		<script type="text/javascript" src="<%=nearestPath%>web/yui/build/datasource/datasource-min.js"></script>
		<script type="text/javascript" src="<%=nearestPath%>web/yui/build/datatable/datatable-min.js"></script>
		<script type="text/javascript" src="<%=nearestPath%>web/scripts/dialogpanel.js"></script>
		<script type="text/javascript" src="<%=nearestPath%>web/scripts/common.js"></script>
		<script type="text/javascript" src="<%=nearestPath%>web/scripts/add-report.js"></script>
        <script language="javascript" src="<%=nearestPath%>web/scripts/admin.js"></script>
        <script language="javascript" src="<%=nearestPath%>web/scripts/messages.js"></script>
        <script language="javascript" src="<%=nearestPath%>web/scripts/common.js"></script>
        <script language="javascript" src="<%=nearestPath%>web/scripts/tt.js"></script>
        <script language="javascript" src="<%=nearestPath%>web/scripts/ac.js"></script>
        <script language="javascript" src="<%=nearestPath%>web/scripts/usermgmt.js"></script>
		
		<script type="text/javascript" src="<%=nearestPath%>web/yui/build/paginator/paginator-min.js"></script>
		
	<script language="javascript">
		YAHOO.namespace("transbit.tbits");
	    YAHOO.transbit.tbits.contextPath = "<%=nearestPath%>";
    </script>
	
	<!--script language="javascript">
		function openAddDisplayGroup(){
			var url = "<%=nearestPath%>displaygrouphandler/" + sysPrefix + "?actionType=getAddPage";
			window.open(url,'_blank','left=20, top=20, height=200, width=500,toolbar=yes, location=yes,status=yes, resize=yes, menubar=yes, scrollbars=yes,copyhistory=yes');	
		}
	</script-->
	
    </head>
    <body class="bgwhite" onLoad="onLoadBody(); getTable();"> <!-- main-navigator -->
        <FORM name="adminDisplayGroupsForm" id="adminDisplayGroupsForm">
            <input type="hidden" name="nearestPath" id="nearestPath" value="<%=nearestPath%>" />
            <DIV class="hb bhs" style="margin: 0ex 1ex 0.5ex 1ex;"><!-- properties -->
                <DIV class="hsp yui-skin-sam">
                   <div>
						<h3>Mailing Lists</h3>	
					</div>
					<div id="basic"></div><br>
					<div>
						<input type="button" value="Add Mailing List" onClick="javascript:showAddMailingListPanel('getAddPage','')">
					</div>
					
					<div class="yui-skin-sam" >
						<div id="resizablepanel">
							<div class="hd">Create/Edit Mailing List</div>
							<div class="bd">
								<iframe id="importdatapage" width="100%" height="100%" scrolling="no" frameborder="no"> </iframe>
							</div>
						   <div class="ft"></div>
						</div>	
					</div>	
                </DIV>               
            </DIV>
            <DIV style="display: none;" id="allTypeFields" name="allTypeFields" width="100px">
                <%=allTypeFields%>
            </DIV>
        </FORM>
		<script type="text/javascript">
			YAHOO.namespace ("tbits.mailinglists");
			function getTable(){
				var rTable = executeHttpRequest("POST","<%=nearestPath%>mailinglisthandler/" +
															"?actionType=getMailingLists", false);		
				YAHOO.tbits.mailinglists.mailingListsData = eval (rTable);	
			}		
		
			YAHOO.util.Event.addListener(window, "load", function() {
				YAHOO.tbits.mailinglists.tableHandler = new function() {
					var myColumnDefs = [{key:"edit", label:"Edit", formatter:YAHOO.widget.DataTable.formatButton},
										{key:"delete",label:"Delete", formatter:function(elCell) {
											elCell.innerHTML = "<img src= \"/web/images/ckdeny.gif\" title= \"delete row\"/>";
											elCell.style.cursor = "pointer";
										}},
										{key:"name", label:"Mailing List Name", sortable:true, editor:"textbox"},
										{key:"users", label:"Mailing List Users", sortable:true, editor:"textbox", maxAutoWidth:400}
										];							
					this.myDataSource = new YAHOO.util.DataSource(YAHOO.tbits.mailinglists.mailingListsData);
					this.myDataSource.responseType = YAHOO.util.DataSource.TYPE_JSARRAY;
					this.myDataSource.responseSchema = {
						fields: ["name","users","edit"]
					};
					var myConfigs = {
                   paginator: new YAHOO.widget.Paginator({
                   rowsPerPage: 10,
                   template: YAHOO.widget.Paginator.TEMPLATE_ROWS_PER_PAGE,
                   rowsPerPageOptions: [5,10,15,20]
                   //pageLinks: 5
                   })
				   }
			
					this.myDataTable = new YAHOO.widget.DataTable("basic",
							myColumnDefs, this.myDataSource,myConfigs);
					
					/*this.myDataTable.subscribe("checkboxClickEvent", function(oArgs){	
						var elCheckbox = oArgs.target;
						var oRecord = this.getRecord(elCheckbox);
						var column = this.getColumn(elCheckbox);	
						if (column.key == "is_active")	
							oRecord.setData("is_active", elCheckbox.checked);	
					});*/
			
					this.myDataTable.subscribe("buttonClickEvent", function(oArgs){			
						var oRecord = this.getRecord(oArgs.target);
						var column = this.getColumn(oArgs.target);
						if (column.key == "edit"){
							showAddMailingListPanel("getEditPage", oRecord.getData ("name"));
						}
						//alert(YAHOO.lang.dump(oRecord.getData()));
					});				
							
					this.myDataTable.subscribe("cellDblclickEvent",this.myDataTable.onEventShowCellEditor);
					this.myDataTable.subscribe("cellClickEvent",function(ev) {	
						var target = YAHOO.util.Event.getTarget(ev); 
						var column = this.getColumn(target);
						var arecord = this.getRecord(target);
						if (column.key == "delete") {
							if (confirm("Are you sure you want to delete the mailing list \"" + arecord.getData ("name") + "\"?")){
								var query = "?actionType=delete&name=" + arecord.getData ("name");
								var resp = executeHttpRequest ("GET","<%=nearestPath%>mailinglisthandler/" + query ,false);							
								if (eval (resp) == true) {							
									this.deleteRow(target);													
								}
							}
						} /*else {
							//this.myDataTable.onEventShowCellEditor(ev);
						}*/
					});
				};
			});
		</script>
		<script type="text/javascript">
			YAHOO.util.Event.onDOMReady(initPanel);            	       	       	       	   
			function showAddMailingListPanel(actionType, mailingListName) {
			var query;
			if (actionType == 'getAddPage')
				query = "?actionType=" + actionType;
			else 
				query = "?actionType=" + actionType + "&name=" + mailingListName;
			showPanel(null, "<%=nearestPath%>mailinglisthandler/" + query);	
			
		}
		</script>
		<br/>
		<br/>
		<br/>
		<br/>
		<br/>
		<br/>
		<br/>
		<br/>
		<br/>
		<br/>
		<br/>
		<br/>
		<br/>
		<br/>
		<br/>
		<br/>
		<br/>
		<br/>
		<br/>
		<br/>
		<br/>
		<br/>
		<br/>
		<br/>
		<br/>
		<br/>
		<br/>
		<br/>
		<br/>
		<br/>
		<br/>
		<br/>
		<br/>
		<br/>
		<br/>
		<br/>
    </body>
</html>
