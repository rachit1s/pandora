<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
    <head>
        <title>tBits: Options</title>
        <meta name="GENERATOR" content="Microsoft Visual Studio .NET 7.1">
        <meta name="vs_targetSchema" content="http://schemas.microsoft.com/intellisense/ie5">
        <link rel="stylesheet" type="text/css" media="screen" href="<%=nearestPath%>web/css/<%=cssFile%>" />
        <script language="javascript" src="<%=nearestPath%>web/scripts/common.js"></script>
        
        <script language="javascript" src="<%=nearestPath%>web/scripts/messages.js"></script>
        <script type="text/javascript" src="<%=nearestPath%>web/yui/build/yahoo/yahoo-min.js"></script>
	<script language="javascript">
		YAHOO.namespace("transbit.tbits");
	    	YAHOO.transbit.tbits.contextPath = "<%=nearestPath%>";
        </script>
        <script language="javascript">
		var TT_BA = "Select a default business area for the Search and Add <%=captions.all.camel_case_request%> pages.";
		var TT_MR = "This specifies your relationship to the <%=captions.all.request%> displayed.";
		var TT_TZ = "Select server time or browser time. Click the link for more details.";
		var TT_AS = "Select autosave frequency of drafts.";
		var TT_SR = "Specify the display of <%=captions.view.subrequests%> and parent <%=captions.all.requests%>. Click the link for more details.";
		var TT_RC = "Specify the number of search results per page.";
		var TT_AR = "Select autorefresh frequency of search results.";
		var TT_VD = "Specify the order of the updates in the display. <br>The default is descending: most recent first.";
		var TT_DF = "Specify date/time format for <%=captions.all.request%> details page.";
		var TT_NOTIFY = "Checking this option suppresses all email for this business area.";
		var TT_VACATION = "This option suppresses email for the selected business areas, unless you are explicitly listed as Author, Reviewer, Subscriber or Cc.";
		</script>
		<script language="javascript" src="<%=nearestPath%>web/scripts/options.js"></script>

		<link rel="stylesheet" type="text/css" href="<%=nearestPath%>web/yui/build/fonts/fonts-min.css" />
		<link rel="stylesheet" type="text/css" href="<%=nearestPath%>web/yui/build/tabview/assets/skins/sam/tabview.css" />
		
		<script type="text/javascript" src="<%=nearestPath%>web/yui/build/yahoo-dom-event/yahoo-dom-event.js"></script>
		<script type="text/javascript" src="<%=nearestPath%>web/yui/build/element/element-min.js"></script>
		<script type="text/javascript" src="<%=nearestPath%>web/yui/build/tabview/tabview-min.js"></script>
		
		</head><body class="bhs yui-skin-sam" onLoad="onLoadBody"  style="margin:0px 1px 0px 1px" onkeydown="onKeyDownBody()">
        <!-- main-navigator -->
		
     <DIV class=" bbn " style="margin-bottom:5px">
                <TABLE id="Table1" height="41" cellSpacing="0" cellPadding="0" width="100%">
                    <TR class="sxs">
                    <td width="114" class ="head1"></td>					
                        <TD width="4" align="left" class ="head2">
                            <DIV class="m">							 
                              <div align="right"><SPAN class="cw b" id="">&nbsp;Settings</SPAN>&nbsp;
							 
                              </div>
                            </DIV>
                        </TD>
                        <TD align="right" class="cw head2" >
						<span class="lc sx b cw" style="padding-right: 2px;"><%=userLogin%></span><span class="l sx b cw" style="display:<%=display_logout%>">|<a href="<%=nearestPath%>logout"/>Logout</a></span><br>
                            <%=appName%>
                            Version:&nbsp;<%=appVersion%>
                        </TD>
                    </TR>
              </TABLE>
            </DIV> <!-- body -->
            <div id="settings" class="yui-navset">
				<ul class="yui-nav">
					<li class="selected"><a href="#general"><em>General</em></a></li>
					<li><a href="#changepassword"><em>Change Password</em></a></li>
				</ul>   
				<div class="yui-content">         
	            	<div class="m" style="margin-right: -0.5ex;" id="general">
			<form name="myOptionForm" ID="myOptionForm" method="post" action="<%=nearestPath%>options/<%=sysPrefix%>">
            <input type="hidden" name="systemId" id="systemId" value="<%=systemId%>"> <input type="hidden" name="sysPrefix" value="<%=sysPrefix%>" ID="sysPrefix" />
            <input type="hidden" name="action" id="action" value=""> <input type="hidden" name="vacation" id="vacation" value="">
            <input type="hidden" name="notify" id="notify" value=""> <input type="hidden" name="analystBAList" id="analystBAList" value="<%=analystBAList%>">
                <TABLE cellSpacing="5" cellPadding="0" width="99%">
                    <COLGROUP>
                        <COL width="10%">
                        <COL width="10%">
                        <COL width="10%">
                        <COL width="70%">
                    </COLGROUP>
                    <TR>
                        <TD class="sx" noWrap align="left">
                            <span class="l help" onMouseOver="this.T_HIDE_ONMOUSEOUT = 'true';var event = (!document.all) ? event : window.event;return escape(TT_BA);" onClick="window.open('<%=nearestPath%>web/tbits-help.htm#optionsDialog');">
                                Default business area </span>
                        </TD>
                        <TD>&nbsp;
                        </TD>
                        <TD class="sx" align="left"><SELECT tabIndex="1" size="1" name="businessArea" ID="businessArea">
                                <%=businessAreaList%>
                            </SELECT>
                        </TD>
                        <TD></TD>
                    </TR>
                    <TR>
                        <TD class="sx" noWrap align="left" valign="top">
                            <span class="l help" onMouseOver="this.T_HIDE_ONMOUSEOUT = 'true';var event = (!document.all) ? event : window.event;return escape(TT_MR);" onClick="window.open('<%=nearestPath%>web/tbits-help.htm#optionsDialog');">
                                Filter '<%=captions.all.my_requests%>' by</span>
                        </TD>
                        <TD>&nbsp;
                        </TD>
                        <TD class="sx" align="left">
                            <input id="chboxLogger" type="checkbox" value="1" <%=loggerChecked%> NAME="chboxLogger"><span style="cursor:default" onClick="toggleCheckBox('chboxLogger')">Logger</span><br>
                            <input id="chboxAssignee" type="checkbox" value="1" <%=assigneeChecked%> NAME="chboxAssignee"><span style="cursor:default" onClick="toggleCheckBox('chboxAssignee')">Assignee</span><br>
                            <input id="chboxSubscriber" type="checkbox" value="1" <%=subscriberChecked%> NAME="chboxSubscriber"><span style="cursor:default" onClick="toggleCheckBox('chboxSubscriber')">Subscriber</span><br>
                            <input id="chboxPrimaryAssignee" type="checkbox" value="1" <%=primaryAssigneeChecked%> NAME="chboxPrimaryAssignee"><span style="cursor:default" onClick="toggleCheckBox('chboxPrimaryAssignee')">Primary 
                                Assignee</span><br>
                        </TD>
                        <TD></TD>
                    </TR>
                    <TR>
                        <TD class="sx" noWrap align="left">
                            <span class="l help" onMouseOver="this.T_HIDE_ONMOUSEOUT = 'true';var event = (!document.all) ? event : window.event;return escape(TT_TZ);" onClick="window.open('<%=nearestPath%>web/tbits-help.htm#TimeZone');">
                                Time zone</span>
                        </TD>
                        <TD>&nbsp;
                        </TD>
                        <TD class="sx" align="left"><SELECT size="1" name="preferredZone" ID="preferredZone" tabIndex="8">
                                <%=preferredZoneList%>
                            </SELECT>
                        </TD>
                        <TD></TD>
                    </TR>
                    <TR>
                        <TD class="sx" noWrap align="left">
                            <span class="l help" onMouseOver="this.T_HIDE_ONMOUSEOUT = 'true';var event = (!document.all) ? event : window.event;return escape(TT_AS);" onClick="window.open('<%=nearestPath%>web/tbits-help.htm#optionsDialog');">
                                Save draft </span>
                        </TD>
                        <TD>&nbsp;
                        </TD>
                        <TD class="sx" align="left"><SELECT size="1" name="autoSaveRate" ID="autoSaveRate" tabIndex="6">
                                <%=autoSaveRate%>
                            </SELECT>
                        </TD>
                        <TD></TD>
                    </TR>
                    <TR>
                        <TD class="bos" colSpan="4" height="2"></TD>
                    </TR>
                    <TR>
                        <TD colSpan="4" class="sx b" height="2">Search results:</TD>
                    </TR>
                    <TR>
                        <TD class="sx" noWrap align="left">
                            <span class="l help" onMouseOver="this.T_HIDE_ONMOUSEOUT = 'true';var event = (!document.all) ? event : window.event;return escape(TT_RC);" onClick="window.open('<%=nearestPath%>web/tbits-help.htm#optionsDialog');">
                                Results per page</span>
                        </TD>
                        <TD>&nbsp;
                        </TD>
                        <TD class="sx" align="left"><SELECT size="1" name="resultsPerPage" ID="resultsPerPage" tabIndex="4">
                                <%=resultsPerPage%>
                            </SELECT>
                        </TD>
                        <TD></TD>
                    </TR>
                    <TR>
                        <TD class="sx" noWrap align="left">
                            <span class="l help" onMouseOver="this.T_HIDE_ONMOUSEOUT = 'true';var event = (!document.all) ? event : window.event;return escape(TT_AR);" onClick="window.open('<%=nearestPath%>web/tbits-help.htm#optionsDialog');">
                                Refresh </span>
                        </TD>
                        <TD>&nbsp;
                        </TD>
                        <TD class="sx" align="left"><SELECT size="1" name="refreshRate" ID="refreshRate" tabIndex="6">
                                <%=refreshRate%>
                            </SELECT>
                        </TD>
                        <TD></TD>
                    </TR>
                    <TR>
                        <TD class="bos" colSpan="4" height="2"></TD>
                    </TR>
                    <TR>
                        <TD colSpan="4" class="sx b" height="2"><%=captions.view.request_details%>:</TD>
                    </TR>
                    <TR>
                        <TD class="sx" noWrap align="left">
                            <span class="l help" onMouseOver="this.T_HIDE_ONMOUSEOUT = 'true';var event = (!document.all) ? event : window.event;return escape(TT_VD);" onClick="window.open('<%=nearestPath%>web/tbits-help.htm#optionsDialog');">
                                Sort order of updates</span>
                        </TD>
                        <TD>&nbsp;
                        </TD>
                        <TD class="sx" align="left"><SELECT id="actionOrder" size="1" name="actionOrder" tabIndex="3">
                                <%=actionOrder%>
                            </SELECT>
                        </TD>
                        <TD></TD>
                    </TR>
                    <TR>
                        <TD class="sx" noWrap align="left">
                            <span class="l help" onMouseOver="this.T_HIDE_ONMOUSEOUT = 'true';var event = (!document.all) ? event : window.event;return escape(TT_DF);" onClick="window.open('<%=nearestPath%>web/tbits-help.htm#optionsDialog');">
                                Date format</span>
                        </TD>
                        <TD>&nbsp;
                        </TD>
                        <TD class="sx" align="left"><SELECT size="1" name="dateFormat" tabIndex="7" ID="dateFormat">
                                <%=dateFormatList%>
                            </SELECT>
                        </TD>
                        <TD></TD>
                    </TR>
                    <TR>
                        <TD class="bos" colSpan="4" height="2"></TD>
                    </TR>
                    <TR>
                        <TD class="sx" noWrap align="left" colSpan="4"><INPUT class="chbox" type="checkbox" value="ON" id="singleWindow"  <%=singleWindow%> name="singleWindow" tabIndex="9" >
                            <span style="cursor:default" onClick="toggleCheckBox('singleWindow')">Open all 
                                <%=captions.all.requests%> for a business area in the same window.</span>
                        </TD>
                    </TR>
                    <TR>
                        <TD class="sx" noWrap align="left" colSpan="4"><INPUT class="chbox" type="checkbox" value="ON" ID="autoClose" name="autoClose"  <%=autoClose%>  tabIndex="10" >
                            <span style="cursor:default" onClick="toggleCheckBox('autoClose')">Close browser 
                                windows automatically after submit.</span>
                        </TD>
                    </TR>
                    <TR>
                        <TD class="sx" noWrap align="left" colSpan="4"><INPUT class="chbox" type="checkbox" value="ON" id="actionHeader" name="actionHeader" <%=actionHeader%> tabIndex="11" >
                            <span style="cursor:default" onClick="toggleCheckBox('actionHeader')">Expand header 
                                in '<%=captions.view.request_details%>' page.</span>
                        </TD>
                    </TR>
                    <TR>
                        <TD class="bos" colSpan="4" height="2"></TD>
                    </TR>
                    <TR style="display:<%=catProfileDisplay%>">
                        <TD align="left" colSpan="4">
                            <span class="sx b">Business Area Settings:</span><br><br>
                            <TABLE cellSpacing="0" cellPadding="0" width="100%" class="results">
                                <colgroup>
                                    <col width="33%" />
                                    <col width="33%" />
                                    <col width="34%" />
                                </colgroup>
                                <thead>
                                    <TR>
                                        <td style="color:black">Business Area</td>
                                        <td><SPAN class="l help" onMouseOver="this.T_HIDE_ONMOUSEOUT = 'true'; this.T_WIDTH = 220; var event = (!document.all) ? event : window.event;return escape(TT_NOTIFY);">Disable 
                                                email</SPAN></td>
                                        <td><span class="l help" onMouseOver="this.T_HIDE_ONMOUSEOUT = 'true'; this.T_WIDTH = 220; var event = (!document.all) ? event : window.event;return escape(TT_VACATION);">Vacation</span>
                                        </td>
                                    </TR>
                                </thead>
                                <tbody>
                                    <%=myAnalystVacationBAList%>
                                </tbody>
                            </TABLE>
                        </TD>
                    </TR>
                </TABLE>
				 <DIV class="arhm">
                <TABLE id="Table4" cellSpacing="0" cellPadding="0" width="700px">
                    <TR>
                        <TD align="left"><INPUT class="sx" ID="revert" type="button" value="Revert to Default Settings" name="revert"
                                onclick="return onRevert()">
                        </TD>
                        <td align="center">
                            <input type="button" onClick="viewCatProfile()" value="View My BA Profile" />
                        </td>
                        <TD align="right"><INPUT class="cw b bn sxs lsb" id="submit" type="submit" name="submit" onClick="return onSubmit()"
                                value="Save Settings">
                        </TD>
                    </TR>
                    <TR>
                        <td align="right" colspan="3" style="padding-top: 10px;">
                            <span class="sx l u cb" id="closeLink" name="closeLink" onClick="window.close();">Close 
                                window</span>
                        </td>
                    </TR>
                </TABLE>
            </DIV>
            </form>

           
        </div>
		<div id="changepassword">
					  <div class="m" style="margin-right: -0.5ex;">
                        <div id="changepasswordmessage" style="font-weight:bold;"></div>
                        <table cellpadding="0" cellspacing="5" width="99%">
                          <colgroup>
                          <col width="10%">
                          <col width="10%">
                          <col width="10%">
                          <col width="70%">
                          </colgroup>
                          <tbody>
                            <tr>
                              <td width="14%" align="left" nowrap="nowrap" class="sx">Old Password</td>
                              <td width="2%">&nbsp;</td>
                              <td width="81%" align="left" class="sx"><input type="password" name="oldpasswd" id="oldpasswd"/></td>
                            </tr>
                            <tr>
                              <td class="sx" align="left" nowrap="nowrap" valign="top">New Password</td>
                              <td>&nbsp;</td>
                              <td class="sx" align="left"><input type="password" name="newpasswd1"  id="newpasswd1"/></td>
                            </tr>
                            <tr>
                              <td class="sx" align="left" nowrap="nowrap">Confirm New Password</td>
                              <td>&nbsp;</td>
                              <td class="sx" align="left"><input type="password" name="newpasswd2" id="newpasswd2"/></td>
                            </tr>
                          </tbody>
                        </table>
					    <div class="arhm">
                          <table id="Table4" cellpadding="0" cellspacing="0" width="700">
                            <tbody>
                              <tr>
                                <td align="left"><input class="cw b bn sxs lsb" id="submit" name="submit22" onClick="onChangePassword()" value="Save" type="button"></td>
                              </tr>
                              <tr>
                                <td colspan="3" style="padding-top: 10px;" align="right"><span class="sx l u cb" id="closeLink" name="closeLink" onClick="window.close();">Close window</span> </td>
                              </tr>
                            </tbody>
                          </table>
				        </div>
				      </div>
					</form>
					</div>
				</div>
			</div>
        <script language="javascript" src="<%=nearestPath%>web/scripts/wtt.js"></script>
    </body>
    <script language="javascript">
        if (document.all)
        {
            window.resizeTo(750, getAbsoluteTop(document.getElementById("closeLink")) + 90);
        }
        function  onClickDisableEmail(id)
        {
            var chbox = document.getElementById(id);
            var ctrl = document.getElementById("str_" + id);
            if (ctrl)
            {
                if (chbox && chbox.checked == true)
                {
                    ctrl.innerHTML = "Disabled";
                }
                else
                {
                    ctrl.innerHTML = "";
                }
            }
        }
        
        function onClickOnVacation(id)
        {
            var chbox = document.getElementById(id);
            var ctrl = document.getElementById("str_" + id);
            if (ctrl)
            {
                if (chbox && chbox.checked == true)
                {
                    ctrl.innerHTML = "On vacation";
                }
                else
                {
                    ctrl.innerHTML = "";
                }
            }
        }
		function onChangePassword()
		{
			var oldPassword = encodeURIComponent(document.getElementById("oldpasswd").value);
			var newPassword = encodeURIComponent(document.getElementById("newpasswd1").value);
			var newPasswordConfirm = encodeURIComponent(document.getElementById("newpasswd2").value);
			var msgBox = document.getElementById("changepasswordmessage");
			msgBox.innerHTML = "";
			if(newPassword != newPasswordConfirm)
			{
				msgBox.innerHTML = "New passwords do not match.";
				return;
			}
			if(newPassword.length == 0)
			{
				msgBox.innerHTML = "New passwords can not be blank.";
				return;
			}
			//send request
			var url = "<%=nearestPath%>changepassword?oldpasswd=" + oldPassword + "&newpasswd=" + newPassword;
			var output = executeHttpRequest("GET", url);
			msgBox.innerHTML = output;
		}
    </script>
	<script type="text/javascript">
		var tabView = new YAHOO.widget.TabView('settings');
	</script>
		
</html>
