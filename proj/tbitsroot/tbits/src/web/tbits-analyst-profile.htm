<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
    <head>
        <title>
            <%=fieldName%>
            Details of '<%=userLogin%>' in '<%=baName%>'</title>
        <LINK media="screen" href="<%=nearestPath%>web/css/tbits.css" type="text/css" rel="stylesheet">
    </head>
    <body class="dialog" onkeydown="javascript:onKeyDownBody()" onload="onLoadBody()">
        <div id="analystProfile" name="" style="width: 100%; display: <%=profileDisplay%>">
            <table class="sx">
                <tr>
                    <td>
                        Business Area:</td>
                    <td>
                        <SELECT id="sysList" name="sysList" onchange="onChangeBA()" tabIndex="1">
                            <%=baList%>
                        </SELECT></td>
                </tr>
                <tr>
                    <td>Field:
                    </td>
                    <td><select name="fieldList" id="fieldList" onchange="onChangeFieldList()" tabIndex="2">
                            <%=fieldList%>
                        </select></td>
                </tr>
            </table>
            <TABLE cellSpacing="0" cellPadding="0" ID="myTable" style="margin-top: 10px;" name="myTable"
                class="results" style="width: 100%; display: <%=tableDisplay%>">
                <%=typeInfo%>
            </TABLE>
            <div class="s b" id="infoMessage" name="infoMessage" style="width: 100%; height: 10px;display: <%=infoDisplay%>">
                <!-- 
                    TODO: Message to convey that user is subscribed to none of the types in this field. 
                -->
                You have not been subscribed to email notification for any
                <%=fieldName%>
                value.
            </div>
            <br>
            <div style="HEIGHT: 25px width: 100%;" align="right">
                <INPUT class="cmd-btn" id="close" style="WIDTH: 65px" onclick="window.close();" type="button"
                    tabIndex="3" value="Close" name="close">&nbsp;&nbsp;
            </div>
        </div>
        <div id="errMessage" name="errMessage" style="width: 100%; display: <%=errorDisplay%>">
            <!-- 
                TODO: Message to convey that user is not associated with atleast one BA. 
            -->
            <table style="width:100%" cellpadding="0" cellspacing="0">
                <tr>
                    <td height="30px">&nbsp;</td>
                </tr>
                <tr>
                    <td class="sx b">
                        You have not been assigned roles in any Business Areas.
                    </td>
                </tr>
                <tr>
                    <td height="30px">&nbsp;</td>
                </tr>
                <tr>
                    <td align="right">
                        <span class="sx u l cb" onclick="window.close()">Close Window</span></td>
                </tr>
            </table>
        </div>
    </body>
    <script language="javascript">
        // JScript source code
        function replace(str, value)
        {
	        var result = str;
	        var regex1 = new RegExp("^" + value + ",");
	        var regex2 = new RegExp("," + value + ",");
	        var regex3 = new RegExp("," + value + "$");
        	
	        result = result.replace(regex1, "");
	        result = result.replace(regex2, ",");
	        result = result.replace(regex3, "");
	        return result;
        }

        function trim(str)
        {
	        if (str == null) return "";
	        str = str.replace(/^\s+/, "");
	        str = str.replace(/\s+$/, "");
	        return str;
        }

        function onKeyDownBody()
        {
	        if (event.keyCode == 13 || event.keyCode == 27)
	        {
		        window.close();
	        }
        }

        function onChangeBA()
        {
            var sysPrefix = document.getElementById("sysList").value;
            var fieldName = document.getElementById("fieldList").value;
            var location = "<%=nearestPath%>analyst-profile/" + sysPrefix + "?sysPrefix=" + sysPrefix + "&fieldName=" + fieldName;
            window.location = location;
        }
        function onChangeFieldList()
        {
            var sysPrefix = document.getElementById("sysList").value;
            var fieldName = document.getElementById("fieldList").value;
            var location = "<%=nearestPath%>analyst-profile/" + sysPrefix + "?sysPrefix=" + sysPrefix + "&fieldName=" + fieldName;
            window.location = location;
        }
        function onLoadBody()
        {
	        var height = document.getElementById("myTable").offsetHeight + 170;
	        if (height > 750) height = 750
	        window.resizeTo(560, height);
        }
    </script>
</html>
